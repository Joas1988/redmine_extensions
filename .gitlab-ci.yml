# This file is generated by GitLab CI
before_script:
  - export HOME=/home/gitlab-runner
  - export LC_ALL=en_US.UTF-8
  - ''
  - export BRANCH=devel
  - ''
  - rvm use ruby 2.3.1 > /dev/null 2>&1
  - ruby -v
  - export REDMINE_SUBDIR="spec/redmine"

Pure Redmine / MySQL:
  tags:
  - mysql
  script:
  - export ADAPTER="mysql2"
  - export DB_USERNAME="root"
  - export DB_PWD=$MYSQL_PASS
  - git clone https://github.com/redmine/redmine.git spec/redmine
  - sed "s/..\/Gemfile/..\/..\/..\/Gemfile/" -i spec/redmine/config/boot.rb
  - $SHELL ./.run-tests.sh
  except:
  - master
  - devel
  - stable

Pure Redmine / Postgresql:
  tags:
  - postgresql
  script:
  - export ADAPTER="postgresql"
  - export DB_USERNAME="postgres"
  - export DB_PWD=""
  - git clone https://github.com/redmine/redmine.git spec/redmine
  - sed "s/..\/Gemfile/..\/..\/..\/Gemfile/" -i spec/redmine/config/boot.rb
  - $SHELL ./.run-tests.sh
  except:
  - master
  - devel
  - stable

# EasyRedmine / MySQL:
#   tags:
#   - mysql
#   script:
#   - rm -rf spec/redmine
#   - git clone https://$GITLAB_FETCH_USER:$GITLAB_FETCH_PASSWORD@git.easy.cz/easyproject/devel.git -b devel spec/redmine
#   - sed "s/..\/Gemfile/..\/..\/..\/Gemfile/" -i spec/redmine/config/boot.rb
#   - 'sed ''s/pattern = "\.\/plugins/pattern = "#{Rails.root}\/plugins/'' -i spec/redmine/plugins/easyproject/easy_plugins/easy_extensions/lib/tasks/tests.rake'
#   - export EASY='true'
#   - export ADAPTER="mysql2"
#   - export DB_USERNAME="root"
#   - export DB_PWD=$MYSQL_PASS
#   - ''
#   - $SHELL ./.run-tests.sh
#   except:
#   - master
