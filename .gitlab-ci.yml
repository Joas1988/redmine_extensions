# This file is generated by GitLab CI
before_script:
  - export HOME=/home/gitlab-runner
  - export LC_ALL=en_US.UTF-8
  - ''
  - export BRANCH=devel
  - ''
  - rvm use ruby 2.3.1 > /dev/null 2>&1
  - ruby -v

Pure Redmine / MySQL:
  script:
  - $SHELL ./.run-tests.sh
  tags:
  except:
  - master

EasyRedmine / MySQL:
  script:
  - EASY='yes'
  - rm -rf spec/redmine
  - git clone https://$GITLAB_FETCH_USER:$GITLAB_FETCH_PASSWORD@git.easy.cz/easyproject/stable-2014.git spec/redmine
  - sed "s/..\/Gemfile/..\/..\/..\/Gemfile/" -i spec/redmine/config/boot.rb
  - 'sed ''s/pattern = "\.\/plugins/pattern = "#{Rails.root}\/plugins/'' -i spec/redmine/plugins/easyproject/easy_plugins/easy_extensions/lib/tasks/tests.rake'
  - ''
  - $SHELL ./.run-tests.sh

#  - bundle exec rake test:prepare RAILS_ENV=test
#  - bundle exec rake easyproject:tests:spec RAILS_ENV=test
  tags:
  except:
  - master
